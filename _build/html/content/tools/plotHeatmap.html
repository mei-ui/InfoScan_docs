<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>plotHeatmap &mdash; InfoScan 0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom-style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> InfoScan
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../InfoUpload.html">InfoUpload</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NovelScan.html">NovelScan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CellInfo.html">CellInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">InfoScan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>plotHeatmap</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/content/tools/plotHeatmap.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plotheatmap">
<h1>plotHeatmap<a class="headerlink" href="#plotheatmap" title="Permalink to this headline"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#details" id="id2">Details</a></p></li>
<li><p><a class="reference internal" href="#usage-examples" id="id3">Usage examples</a></p>
<ul>
<li><p><a class="reference internal" href="#multiple-colors-for-heatmaps" id="id4">Multiple colors for heatmaps</a></p></li>
<li><p><a class="reference internal" href="#no-box-around-heatmaps" id="id5">No box around heatmaps</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="details">
<h2><a class="toc-backref" href="#id2">Details</a><a class="headerlink" href="#details" title="Permalink to this headline"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With the release of deepTools 2.3 is is now possible to set the color and scale of each heatmap
individually. Also, we added the option to remove the boxes around the heatmaps.</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">plotHeatmap</span></code> does not change the values that <code class="docutils literal notranslate"><span class="pre">computeMatrix</span></code> calculated, it simply translates them into heatmaps and summary plots.
It offers a large variety of parameters to explore various visualizations and customize the resulting image (see the commands above).</p>
<p>In addition, you can retrieve all the data tables underlying the various plots including the regions that were used to generate the final plot.
The following tables summarizes the kinds of optional outputs that are available with the three tools.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 27%" />
<col style="width: 16%" />
<col style="width: 14%" />
<col style="width: 14%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>optional output type</strong></p></td>
<td><p><strong>command</strong></p></td>
<td><p><strong>computeMatrix</strong></p></td>
<td><p><strong>plotHeatmap</strong></p></td>
<td><p><strong>plotProfile</strong></p></td>
</tr>
<tr class="row-even"><td><p>values underlying the heatmap</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--outFileNameMatrix</span></code></p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-odd"><td><p>values underlying the profile</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--outFileNameData</span></code></p></td>
<td><p>no</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-even"><td><p>sorted and/or filtered regions</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">--outFileSortedRegions</span></code></p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For more details on the optional output, see the examples for <a class="reference internal" href="computeMatrix.html"><span class="doc">computeMatrix</span></a>.</p>
</div>
</section>
<section id="usage-examples">
<h2><a class="toc-backref" href="#id3">Usage examples</a><a class="headerlink" href="#usage-examples" title="Permalink to this headline"></a></h2>
<p>The following example creates a heatmap over hg19 transcripts for our test ENCODE datasets. Note that the matrix contains multiple groups of regions (in this case, one for each chromosome used).</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># run compute matrix to collect the data needed for plotting</span>
$ computeMatrix scale-regions -S H3K27Me3-input.bigWig <span class="se">\</span>
                                 H3K4Me1-Input.bigWig  <span class="se">\</span>
                                 H3K4Me3-Input.bigWig <span class="se">\</span>
                              -R genes19.bed genesX.bed <span class="se">\</span>
                              --beforeRegionStartLength <span class="m">3000</span> <span class="se">\</span>
                              --regionBodyLength <span class="m">5000</span> <span class="se">\</span>
                              --afterRegionStartLength <span class="m">3000</span>
                              --skipZeros -o matrix.mat.gz

$ plotHeatmap -m matrix.mat.gz <span class="se">\</span>
      -out ExampleHeatmap1.png <span class="se">\</span>
</pre></div>
</div>
<img alt="images/test_plots/ExampleHeatmap1.png" src="images/test_plots/ExampleHeatmap1.png" />
<p>As mentioned above, <code class="docutils literal notranslate"><span class="pre">plotHeatmap</span></code> has many options, including the ability to do k-means clustering and change the color map.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ plotHeatmap -m matrix_two_groups.gz <span class="se">\</span>
     -out ExampleHeatmap2.png <span class="se">\</span>
     --colorMap RdBu <span class="se">\</span>
     --whatToShow <span class="s1">&#39;heatmap and colorbar&#39;</span> <span class="se">\</span>
     --zMin -3 --zMax <span class="m">3</span> <span class="se">\</span>
     --kmeans <span class="m">4</span>
</pre></div>
</div>
<img alt="images/test_plots/ExampleHeatmap2.png" src="images/test_plots/ExampleHeatmap2.png" />
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>More examples</strong> can be found in our <a class="reference external" href="http://deeptools.readthedocs.org/en/latest/content/example_gallery.html#normalized-chip-seq-signals-and-peak-regions">Gallery</a>.</p>
</div>
<section id="multiple-colors-for-heatmaps">
<h3><a class="toc-backref" href="#id4">Multiple colors for heatmaps</a><a class="headerlink" href="#multiple-colors-for-heatmaps" title="Permalink to this headline"></a></h3>
<p>Since deepTools version 2.3 it is now possible to adjust the color and scale of each heatmap. There are two ways
to adjust the colors, one by specifying each of the colormaps (e.g. <cite>–colorMap RdBlGr winter terrain</cite>) and the
other is by giving each of the colors in the heatmap (e.g. <cite>–colorList ‘red,blue’ ‘white,green’, ‘white, blue, red’</cite>).
For the second example, the number of transitions between the colors is given by the <cite>–colorNumber</cite> which by default
is 256.</p>
<p>The following is an example using the <cite>–colorList</cite> method is used. Also the scale of each heatmap is modified
using <cite>–zMin</cite> and <cite>–zMax</cite>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ plotHeatmap -m matrix_two_groups.gz <span class="se">\</span>
     -out ExampleHeatmap3.png <span class="se">\</span>
     --colorList <span class="s1">&#39;black, yellow&#39;</span> <span class="s1">&#39;white,blue&#39;</span> <span class="s1">&#39;#ffffff,orange,#000000&#39;</span>
     --whatToShow <span class="s1">&#39;heatmap and colorbar&#39;</span> <span class="se">\</span>
     --zMin -2 -2 <span class="m">0</span> --zMax <span class="m">2</span> <span class="m">2</span> <span class="m">3</span>
     --kmeans <span class="m">4</span>
     --dpi <span class="m">100</span>
</pre></div>
</div>
<img alt="images/test_plots/ExampleHeatmap3.png" src="images/test_plots/ExampleHeatmap3.png" />
</section>
<section id="no-box-around-heatmaps">
<h3><a class="toc-backref" href="#id5">No box around heatmaps</a><a class="headerlink" href="#no-box-around-heatmaps" title="Permalink to this headline"></a></h3>
<p>In version 2.3 we also added the option to remove the box around heatmaps. In the following example
we combine different colormap colors, different scales and the new  <cite>–boxAroundHeatmaps</cite> option.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ plotHeatmap -m matrix_two_groups.gz <span class="se">\</span>
     -out ExampleHeatmap4.png <span class="se">\</span>
     --colorMap Oranges_r Blues_r Greens
     --whatToShow <span class="s1">&#39;heatmap and colorbar&#39;</span> <span class="se">\</span>
     --zMin -4 -4 <span class="m">0</span> --zMax <span class="m">0</span> <span class="m">0</span> <span class="m">5</span>
     --kmeans <span class="m">4</span>
     --dpi <span class="m">100</span>
     --boxAroundHeatmaps no
</pre></div>
</div>
<img alt="images/test_plots/ExampleHeatmap4.png" src="images/test_plots/ExampleHeatmap4.png" />
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><strong>More examples</strong> can be found in our <a class="reference external" href="http://deeptools.readthedocs.org/en/latest/content/example_gallery.html#normalized-chip-seq-signals-and-peak-regions">Gallery</a>.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Zilch.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>