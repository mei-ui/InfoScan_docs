<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>plotCoverage &mdash; InfoScan 0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom-style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> InfoScan
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../InfoUpload.html">InfoUpload</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NovelScan.html">NovelScan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CellInfo.html">CellInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">InfoScan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>plotCoverage</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/content/tools/plotCoverage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plotcoverage">
<h1>plotCoverage<a class="headerlink" href="#plotcoverage" title="Permalink to this headline"></a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#what-the-plots-tell-you" id="id1">What the plots tell you</a></p></li>
<li><p><a class="reference internal" href="#usage-example" id="id2">Usage example</a></p></li>
</ul>
</div>
<section id="what-the-plots-tell-you">
<h2><a class="toc-backref" href="#id1">What the plots tell you</a><a class="headerlink" href="#what-the-plots-tell-you" title="Permalink to this headline"></a></h2>
<p>The tool generates a panel of two plots.
The first one simply represents the frequencies of the found read coverages, which helps you judge how relevant the mean coverage value (printed next to the sample name) is. If the distribution of read coverages is more or less homoskedatic and, ideally, normally distributed (most likely it won’t be), then the mean is a very appropriate proxy for sequencing depth.</p>
<p>The second plot helps you answer the question <em>what is the fraction of the genome that has a depth of sequencing of 2?</em></p>
<img alt="images/plotCoverage_annotated.png" src="images/plotCoverage_annotated.png" />
</section>
<section id="usage-example">
<h2><a class="toc-backref" href="#id2">Usage example</a><a class="headerlink" href="#usage-example" title="Permalink to this headline"></a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span> $ plotCoverage -b H3K4Me1.bam H3K4Me3.bam H3K27Me3.bam H3K9Me3.bam
    --plotFile example_coverage
    -n <span class="m">1000000</span>
    --plotTitle <span class="s2">&quot;example_coverage&quot;</span> <span class="se">\</span>
    --outRawCounts coverage.tab <span class="se">\</span>
    --ignoreDuplicates <span class="se">\</span>
    --minMappingQuality <span class="m">10</span> <span class="se">\</span>
    --region <span class="m">19</span>

<span class="c1"># have a look at the optional tabular output: each row represents the number of reads overlapping with a sampled bp</span>
$ head coverage.tab
    <span class="s1">&#39;H3K27me3&#39;</span>        <span class="s1">&#39;H3K4me1&#39;</span>       <span class="s1">&#39;H3K4me3&#39;</span>       <span class="s1">&#39;H3K9me3&#39;</span>
    <span class="m">0</span> <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>
    <span class="m">0</span> <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>
    <span class="m">0</span> <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>
    <span class="m">0</span> <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>
    <span class="m">0</span> <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>
    <span class="m">0</span> <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>
    <span class="m">0</span> <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>
    <span class="m">0</span> <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>
    <span class="m">0</span> <span class="m">0</span>       <span class="m">0</span>       <span class="m">0</span>

$ cut -f1 coverage.tab <span class="p">|</span> sort -n <span class="p">|</span> uniq -c
    <span class="m">1</span> <span class="s1">&#39;H3K27me3&#39;</span>
    <span class="m">548190</span> <span class="m">0</span> <span class="c1"># the vast majority of sampled bp had 0 overlapping reads</span>
    <span class="m">127914</span> <span class="m">1</span>
    <span class="m">35703</span> <span class="m">2</span>
    <span class="m">12271</span> <span class="m">3</span>
    <span class="m">4584</span> <span class="m">4</span>
    <span class="m">1717</span> <span class="m">5</span>
     <span class="m">659</span> <span class="m">6</span>
     <span class="m">251</span> <span class="m">7</span>
     <span class="m">106</span> <span class="m">8</span>
      <span class="m">49</span> <span class="m">9</span>
      <span class="m">16</span> <span class="m">10</span>
       <span class="m">6</span> <span class="m">11</span>
       <span class="m">3</span> <span class="m">12</span>
       <span class="m">2</span> <span class="m">13</span>
       <span class="m">3</span> <span class="m">14</span>
       <span class="m">1</span> <span class="m">15</span>
       <span class="m">1</span> <span class="m">16</span>
       <span class="m">2</span> <span class="m">17</span>
       <span class="m">1</span> <span class="m">19</span>
       <span class="m">1</span> <span class="m">21</span>
       <span class="m">2</span> <span class="m">22</span>
       <span class="m">1</span> <span class="m">23</span>
       <span class="m">1</span> <span class="m">24</span>
       <span class="m">2</span> <span class="m">28</span>
       <span class="m">1</span> <span class="m">35</span>
       <span class="m">1</span> <span class="m">40</span> <span class="c1"># there was one bp with 40 overlapping reads!</span>
       <span class="m">1</span> <span class="m">44</span>
</pre></div>
</div>
<img alt="images/test_plots/ExamplePlotCoverage.png" src="images/test_plots/ExamplePlotCoverage.png" />
<p>As you can see, the coverage of our test data sets is very poor – on average, there is fewer than 1 read per bp!</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Zilch.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>