<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>plotFingerprint QC metrics &mdash; InfoScan 0.1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/custom-style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> InfoScan
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../InfoUpload.html">InfoUpload</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NovelScan.html">NovelScan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CellInfo.html">CellInfo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">InfoScan</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>plotFingerprint QC metrics</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/content/feature/plotFingerprint_QC_metrics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plotfingerprint-qc-metrics">
<h1>plotFingerprint QC metrics<a class="headerlink" href="#plotfingerprint-qc-metrics" title="Permalink to this headline"></a></h1>
<p>As of version 2.4.0, plotFingerprint can optionally output a number of metrics useful for assisting the interpretation of fingerprint plots. A number of these metrics require a matched input sample, which can be specified by <code class="docutils literal notranslate"><span class="pre">--JSDsample</span></code>.</p>
<section id="sequencing-depth-dependence">
<h2>Sequencing-depth dependence<a class="headerlink" href="#sequencing-depth-dependence" title="Permalink to this headline"></a></h2>
<p>An important caveat with all of the QC metrics, except “Synthetic JS distance”, is that sequencing depth plays a roll in the background assumption of what a good value is. This is visually demonstrated below, where the various curves represent what a perfectly behaved input sample should look like with a variety of average sequencing depths (“lambda”).</p>
<img alt="images/plotFingerprintQC2.png" src="images/plotFingerprintQC2.png" />
<p>This plot is equivalent to those generated by <code class="docutils literal notranslate"><span class="pre">plotFingerprint</span></code>, with the axes labeled differently. Note that with low coverage, the background expectation is less a diagonal line from the lower-left to the upper-right and more of a convex curve or, at very low coverage, a straight line with a given X-intercept. For this reason, a number of “Synthetic” metrics are produced for each sample. These represent the metrics for artificial plotFingerprint results like those above. These are useful for putting the results you observe for your samples into perspective. For example, your elbow point of 0.95 for a ChIP sample might not be so impressive if, because of low sequencing depth, an input sample would be expected to have an elbow point of 0.85.</p>
</section>
<section id="the-metrics">
<h2>The metrics<a class="headerlink" href="#the-metrics" title="Permalink to this headline"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There are many QC metrics, of which we find the “JS distance” the most useful!</p>
</div>
<ul class="simple">
<li><p>AUC: The “area under the curve”, with a maximum value of 0.5. Lower values generally indicate higher and more focal enrichment.</p></li>
</ul>
<img alt="images/plotFingerprintQC1.png" src="images/plotFingerprintQC1.png" />
<ul class="simple">
<li><p>Synthetic AUC: The expected area under the curve of a perfectly behaved input sample having the same mean sequencing depth of a given sample. This is useful to put the observed AUC into perspective.</p></li>
<li><p>X-intercept: The point (on the X-axis) at which the curve is not 0. This is approximately the percentage of the genome that was not sequenced in a particular sample. Ideally, this value will be near 0. In practice, however, this can be quite high, due to things like low sequencing depth (see above) or extremely high enrichment resulting in peaks sponging up all of the available reads.</p></li>
<li><p>Synthetic X-intercept: The expected X-intercept of a perfectly behaved input sample having the same mean sequencing depth of a given sample. This is useful to put the observed X-intercept into perspective.</p></li>
<li><p>Elbow Point: The elbow point attempts to measure the position at which the line turns upward. In practice, this is the point at which the plotted line is furthest from the line from the lower-left to the upper-right corner of the graph (equivalent to a perfect input sample with infinite coverage). The point returned is the position on the X-axis of this elbow point and higher values indicate more enrichment.</p></li>
<li><p>Synthetic Elbow Point: The expected elbow point of a perfectly behaved input sample having the same mean sequencing depth of a given sample. This is useful to put the observed elbow point into perspective.</p></li>
<li><p>JS distance: This is the Jensen-Shannon distance between a given sample and that specified by <code class="docutils literal notranslate"><span class="pre">--JSDsample</span></code> and is based on work from Sitanshu Gakkhar. The Jensen-Shannon divergence is defined as follows:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
JSD(P \parallel Q) = \frac{1}{2} D_{KL}(P \parallel M) + \frac{1}{2} D_{KL}(Q \parallel M) \\
M = \frac{1}{2} (P + Q) \\
D_{KL}({X} \parallel {Y}) = \sum_{i} X_i log\Big(\frac{X_i}{Y_i}\Big)
\end{align}\end{split}\]</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">D</span></code> is the Kullback-Leibler divergence. <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code> are the probability mass functions underlying the lines in the plots. The JS distance is the square root of the JS divergence shown above. Higher values indicate greater difference between the two curves, with minimum and maximum values of 0 and 1, respectively.</p>
<ul class="simple">
<li><p>Synthetic JS distance: As shown above, the expected distribution of a perfect input sample is dependent on its sequencing depth, meaning that if a sample and its matched control have very different depths then the JS distance between them is misleading. Consequently, rather than displaying the JS distance between two samples, this metric shows the JS distance between a given sample and a perfect input sample with the same coverage depth (i.e., the plot generated from the Poisson probability mass function with lambda equal to the mean coverage in the sample). Ideally, this metric and that above will be very similar, but may not be if sequencing depth is very different (in which case, this metric is likely more reliable). Note also that this metric is printed even for the sample indicated by the <code class="docutils literal notranslate"><span class="pre">--JSDsample</span></code> option, which is useful to assess the level of bias present in the input sample, which should ideally have coverage with a Poisson distribution.</p></li>
<li><p>% genome enriched: This is a metric originating from the <a class="reference external" href="http://dx.doi.org/10.1186/gb-2012-13-10-r98">CHANCE</a> tool. This is computed by first finding the elbow point (essentially as described above), and then computing 1 minus that. This then represents the approximate percentage of the genome enriched in signal (e.g., bound by a transcription factor or having a certain histone modification).</p></li>
<li><p>diff. enrichment: The differential enrichment between a given sample and that indicated by <code class="docutils literal notranslate"><span class="pre">--JSDsample</span></code> at the elbow point. This is also a metric introduced by the CHANCE tool. Higher percentages are generally better.</p></li>
<li><p>CHANCE divergence: The divergence metric introduced by the CHANCE tools (and seemingly undocumented). In many ways, this is similar to the JS distance metric. The computation starts with the values at the elbow point of a given sample (<code class="docutils literal notranslate"><span class="pre">P</span></code>) and the sample given by <code class="docutils literal notranslate"><span class="pre">--JSDsample</span></code> (<code class="docutils literal notranslate"><span class="pre">Q</span></code>). Given <code class="docutils literal notranslate"><span class="pre">P</span></code> and <code class="docutils literal notranslate"><span class="pre">Q</span></code>, the “CHANCE divergence” is calculated as follows:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
CHANCE divergence = \sqrt{\frac{1}{2} (binRelEntropy(P, M) + binRelEntropy(Q, M))} \\
M = \frac{1}{2} (P + Q) \\
binRelEntropy(X, Y) = X log_2 \Big(\frac{X}{Y}\Big) + (1 - X) log_2 \Big(\frac{1 - X}{1 - Y} \Big)
\end{align}\end{split}\]</div>
<p>The <code class="docutils literal notranslate"><span class="pre">binRelEntropy</span></code> function is similar to a mixture of binary entropy and Kullback-Leibler divergence. Note that if <code class="docutils literal notranslate"><span class="pre">X</span></code> is 0, the <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">*</span> <span class="pre">log2(X/Y)</span></code> is 0. Similarly, if <code class="docutils literal notranslate"><span class="pre">X</span></code> is 1, then <code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">-</span> <span class="pre">X)</span> <span class="pre">*</span> <span class="pre">log2((1</span> <span class="pre">-</span> <span class="pre">X)</span> <span class="pre">/</span> <span class="pre">(1</span> <span class="pre">-</span> <span class="pre">Y))</span></code> is 0.</p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Zilch.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>